machine:
  python:
    version: 3.5.1
  environment:
    PYTHONPATH: ${PYTHONPATH}:${HOME}/google_appengine
    GCLOUD_PROJECT: "voteme-sir"

dependencies:
  pre:
    - bash install_requirements.sh
    - bash ./appengine/setup_gcloud.sh

deployment:
  production:
    pre:
      - pyenv global 2.7.12 2.7.10 3.5.1
      - gcloud app deploy app.yaml --version=1 --project=voteme-sir --verbosity=info
      - python e2e_ping.py

test:
  post:
    - git reset --hard
    - git clean -d -x -f
